<!DOCTYPE html>
<html>
  <head>
    <title>Air Tracker</title>
    <meta charset="utf-8" name="viewport" content="width=device-width, initial-scale=1">

    <link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css" />
    <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Open+Sans:400,700" />
    <link rel="stylesheet" type="text/css" href="https://code.jquery.com/ui/1.13.2/themes/smoothness/jquery-ui.min.css" />
    <link rel="stylesheet" type="text/css" href="./assets/css/controls.css" />
    <link rel="stylesheet" type="text/css" href="./assets/css/widgets.css" />
    <link rel="stylesheet" type="text/css" href="./assets/css/TimelineHeatmap.css" />
    <link rel="stylesheet" type="text/css" href="./assets/css/style.css" />
    <link rel="stylesheet" type="text/css" href="./assets/css/materialUI.css" />
    <link rel="stylesheet" type="text/css" href="./assets/css/bootstrap-fullscreen-select.min.css" />
    <link rel="stylesheet" type="text/css" href="./assets/css/introjs.min.css" />
    <link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/jquery-datetimepicker/2.5.20/jquery.datetimepicker.min.css">

    <script>
      var IS_LOCAL = ["localhost", "file:", "192.168"].some(str => window.location.href.includes(str));
      <!-- NOTE: Edit this to define location of /assets/  Ensure trailing slash. -->
      var ASSETS_ROOT = IS_LOCAL ? "./assets/" : "https://airtracker.createlab.org/assets/";
    </script>

    <script type="text/javascript" src="https://polyfill.io/v3/polyfill.min.js?features=default"></script>
    <script type="text/javascript" src="https://maps.googleapis.com/maps/api/js?key=AIzaSyC6eawl6aLg9CHsJGc86qKcORA3vTcDZUQ&callback=initMap&libraries=geometry,places&v=weekly" defer></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.30.1/moment.min.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/moment-timezone/0.5.45/moment-timezone-with-data-10-year-range.min.js"></script>
    <script type="text/javascript" src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
    <script type="text/javascript" src="https://code.jquery.com/ui/1.13.2/jquery-ui.min.js"></script>
    <script type="text/javascript" src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
    <script type="text/javascript" src="https://www.gstatic.com/firebasejs/8.10.1/firebase-auth.js"></script>
    <script type="text/javascript" src="https://www.gstatic.com/firebasejs/8.10.1/firebase-firestore.js"></script>
    <script type="text/javascript" src="./assets/js/TimelineHeatmap.js" type="text/javascript"></script>
    <script type="text/javascript" src="./assets/js/widgets.js"></script>
    <script type="text/javascript" src="./assets/js/Util.js"></script>
    <script type="text/javascript" src="./assets/js/customTimeline2.js"></script>
    <script type="text/javascript" src="./assets/js/index.js"></script>
    <script type="text/javascript" src="./assets/js/plots.js"></script>
    <script type="text/javascript" src="./assets/js/heatmaps.js"></script>
    <script type="text/javascript" src="./assets/js/timeline.js"></script>
    <script type="text/javascript" src="./assets/js/purpleAirTourHelpers.js"></script>
    <script type="text/javascript" src="./assets/lib/gmaps-utils/map_marker/CustomMapMarker.js"></script>
    <script type="text/javascript" src="./assets/lib/touchPunch/jquery.ui.touch-punch.min.js"></script>
    <script type="text/javascript" src="./assets/lib/bootstrapFullscreenSelect/bootstrap-fullscreen-select.min.js"></script>
    <script type="text/javascript" src="./assets/lib/scrollIntoView/scrollIntoView.min.js"></script>
    <script type="text/javascript" src="./assets/lib/html2canvas/html2canvas.min.js"></script>
    <script type="text/javascript" src="./assets/lib/downloadjs/download.min.js"></script>
    <script type="text/javascript" src="./assets/lib/js-markerwithlabel/js-markerwithlabel-1.3.11.min.js"></script>
    <script type="text/javascript" src="./assets/lib/introjs/intro.min.js"></script>

    <script type="text/javascript" src="./assets/lib/grapher/grapher.min.js"></script>
    <script type="text/javascript" src="./assets/lib/grapher/PlotManager.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/handlebars.js/4.7.7/handlebars.min.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/luxon/3.4.4/luxon.min.js"></script>
    
    <script type="text/javascript" src="./assets/lib/rrule/rrule.min.js"></script>
    
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/jquery-datetimepicker/2.5.20/jquery.datetimepicker.full.min.js"></script>
  </head>
  <body class="materialUI">
    <div id="heatmap-loading-mask"><div class="loader"></div></div>
    <div id="controls" class="playbackTimelineOff" style="display: none">
      <div id="playback-timeline-container" class="noselect materialUI">
        <div class="materialTimelineContainerMain">
          <div class="materialTimelineContainer">
            <div class="timestampPreview disabled" title="Explore more hours in this day"><div id="currentTime"></div></div>
            <div class="playbackButton" title="Play"></div>
            <div class="leftSeekControl" title="Click to seek backward. Press and hold to jump to a different hour."><span class="leftSeekControlIcon"></span></div>
            <div class="materialTimeline"></div>
            <div class="rightSeekControl" title="Click to seek forward. Press and hold to jump to a different hour."><span class="rightSeekControlIcon"></span></div>
          </div>
        </div>
        <div id="timeJumpControl" title="Jump to an hour"></div>
      </div>
      <div id="timeline-container" class="noselect timeline-container"></div>
      <div id="timeline-handle" class="noselect force-no-visibility"><span>Daily AQI&nbsp;-&nbsp;</span><span id='city_name'></span></div>
      <button id="calendar-btn" title="Calendar" class="force-hidden custom-button-flat calendar-default-icon" disabled>
        <div class="calendar-specific-day hidden"></div>
      </button>
    </div>
    <div id="infobar" class='infocontainer no-controls'>
      <div id="infobar-tools">
        <a href="./"><div id="infobar-header" title="Air Tracker"></div></a>
        <div id="infobar-back-arrow-container" title="Exit mode">
          <div id="back-arrow"></div>
          <span id="back-arrow-text">Exit Mode</span>
        </div>
        <span class='more-info more-info-grapher' title="Learn more" data-info="grapher"></span>
        <div id="infobar-tools-wrapper">
          <div id="heatmap">
            <!-- <p class="heading">Source Area Over Time</p> -->
            <p class="description">Generate a heatmap of cumulative source area likelihoods for the clicked location. Choose "Guided Date Picker" to quickly produce a list of date-times, or choose "Manual Entry" to enter in your own list of date-times. If you clicked a sensor on the map when in manual entry mode, you can also obtain date-times from the Time Series chart feature.</p>
            <div class="left-align-content add-top-margin">
              <div class="custom-radio custom-radio-left">
                <input type="radio" name="date-picker-selector" value="gui" id="gui-collection-radio" checked>
                <label for="gui-collection-radio" class="noselect">Guided Date Picker</label>
              </div>
              <div class="custom-radio custom-radio-right">
                <input type="radio" name="date-picker-selector" value="manual" id="manual-collection-radio">
                <label for="manual-collection-radio" class="noselect">Manual Entry</label>
              </div>
            </div>
            <div id="heatmap-manual-date-entry-container" data-radio="manual-collection-radio">
              <p class="description">Enter a list of dates, comma delimited, to create a heatmap of cumulative source area likelihoods for the clicked location, across that set of times. If you clicked a sensor on the map, you can also obtain date-times from the Time Series chart feature found below by clicking data points in the chart. <br><br> Note that dates entered are assumed to be in local time.</p>
              <div class="heatmap-dates-wrapper">
                <p class="description">(e.g. 2022-07-02 15:00, 2022-07-02 16:00)</p>
                <textarea id="heatmap-dates" rows="10" cols="34"></textarea>
              </div>
            </div>
            <div id="heatmap-gui-datepicker-entry-container" data-radio="gui-collection-radio">
              <p class="description">Fill out the form below to generate a series of date-times that will be used to create a heatmap of cumulative source area likelihoods for the clicked location.</p>
              <table id="heatmap-date-picker">
                <tr>
                  <td width="20">
                    <div>From: </div>
                  </td>
                  <td>
                    <div class="input-block">
                      <input id="datetimepicker-start" type="text" placeholder="Start Date Time" autocomplete="off">
                      <i class="fa fa-calendar-alt"></i>
                    </div>
                  </td>
                </tr>
                <tr>
                  <td>
                    Every:
                  </td>
                  <td>
                    <input type="number" id="interval" name="interval" min="1" value="1">
                    <select name="frequency" id="frequency">
                      <option value="RRule.HOURLY">Hour(s)</option>
                      <option value="RRule.DAILY">Day(s)</option>
                      <option value="RRule.WEEKLY">Week(s)</option>
                      <option value="RRule.MONTHLY">Month(s)</option>
                    </select>
                  </td>
                </tr>
                <tr id="hour-row">
                  <td colspan="2">
                    At: (<a href="javascript:void(0)" class="select-all">select all</a>)
                    <div id="hour" class="checkbox-group">
                      <label><input name="byhour" type="checkbox" value="0" checked>12 AM</label>
                      <label><input name="byhour" type="checkbox" value="1" checked>01 AM</label>
                      <label><input name="byhour" type="checkbox" value="2" checked>02 AM</label>
                      <label><input name="byhour" type="checkbox" value="3" checked>03 AM</label>
                      <label><input name="byhour" type="checkbox" value="4" checked>04 AM</label>
                      <label><input name="byhour" type="checkbox" value="5" checked>05 AM</label>
                      <label><input name="byhour" type="checkbox" value="6" checked>06 AM</label>
                      <label><input name="byhour" type="checkbox" value="7" checked>07 AM</label>
                      <label><input name="byhour" type="checkbox" value="8" checked>08 AM</label>
                      <label><input name="byhour" type="checkbox" value="9" checked>09 AM</label>
                      <label><input name="byhour" type="checkbox" value="10" checked>10 AM</label>
                      <label><input name="byhour" type="checkbox" value="11" checked>11 AM</label>
                      <label><input name="byhour" type="checkbox" value="12" checked>12 PM</label>
                      <label><input name="byhour" type="checkbox" value="13" checked>01 PM</label>
                      <label><input name="byhour" type="checkbox" value="14" checked>02 PM</label>
                      <label><input name="byhour" type="checkbox" value="15" checked>03 PM</label>
                      <label><input name="byhour" type="checkbox" value="16" checked>04 PM</label>
                      <label><input name="byhour" type="checkbox" value="17" checked>05 PM</label>
                      <label><input name="byhour" type="checkbox" value="18" checked>06 PM</label>
                      <label><input name="byhour" type="checkbox" value="19" checked>07 PM</label>
                      <label><input name="byhour" type="checkbox" value="20" checked>08 PM</label>
                      <label><input name="byhour" type="checkbox" value="21" checked>09 PM</label>
                      <label><input name="byhour" type="checkbox" value="22" checked>10 PM</label>
                      <label><input name="byhour" type="checkbox" value="23" checked>11 PM</label>
                    </div>
                  </td>
                </tr>
                <tr>
                  <td colspan="2">
                    On: (<a href="javascript:void(0)" class="select-all">select all</a>)
                    <div id="dayofweek" class="checkbox-group">
                    <label><input type="checkbox" name="byweekday" value="RRule.MO" checked>Mon</label>
                    <label><input type="checkbox" name="byweekday" value="RRule.TU" checked>Tue</label>
                    <label><input type="checkbox" name="byweekday" value="RRule.WE" checked>Wed</label>
                    <label><input type="checkbox" name="byweekday" value="RRule.TH" checked>Thu</label>
                    <label><input type="checkbox" name="byweekday" value="RRule.FR" checked>Fri</label>
                    <label><input type="checkbox" name="byweekday" value="RRule.SA" checked>Sat</label>
                    <label><input type="checkbox" name="byweekday" value="RRule.SU" checked>Sun</label>
                    </div>
                  </td>
                </tr>
                <tr>
                  <td colspan="2">
                    Of Every: (<a href="javascript:void(0)" class="select-all">select all</a>)
                    <div id="month" class="checkbox-group">
                      <label><input name="bymonth" type="checkbox" value="1" checked>Jan</label>
                      <label><input name="bymonth" type="checkbox" value="2" checked>Feb</label>
                      <label><input name="bymonth" type="checkbox" value="3" checked>Mar</label>
                      <label><input name="bymonth" type="checkbox" value="4" checked>Apr</label>
                      <label><input name="bymonth" type="checkbox" value="5" checked>May</label>
                      <label><input name="bymonth" type="checkbox" value="6" checked>Jun</label>
                      <label><input name="bymonth" type="checkbox" value="7" checked>Jul</label>
                      <label><input name="bymonth" type="checkbox" value="8" checked>Aug</label>
                      <label><input name="bymonth" type="checkbox" value="9" checked>Sep</label>
                      <label><input name="bymonth" type="checkbox" value="10" checked>Oct</label>
                      <label><input name="bymonth" type="checkbox" value="11" checked>Nov</label>
                      <label><input name="bymonth" type="checkbox" value="12" checked>Dec</label>
                    </div>
                  </td>
                </tr>
                <tr>
                  <td>
                    <div>Until: </div>
                  </td>
                  <td>
                    <div class="input-block">
                      <input id="datetimepicker-end" type="text" placeholder="End Date Time" autocomplete="off">
                      <i class="fa fa-calendar-alt"></i>
                    </div>
                  </td>
                </tr>
              </table>
              <input type="hidden" id="rrule-str">
              <p id="result"></p>
            </div>
          </div>
          <div id="timeseries">
            <div id="grapher_container" class="noselect">
              <div class="alert">
                Only up to 5 sensors can be graphed. Remove one before adding another.
              </div>
              <table id="grapher" border="0" cellpadding="0" cellspacing="0">
                <tr>
                    <td>
                      <div id="date_axis" class="date_axis"></div>
                    </td>
                    <td>
                      <div id="zoomGrapherIn" class="zoomGrapherBtn ui-button ui-widget ui-state-default ui-corner-all ui-button-icon-only" title="Zoom in the graphs">
                        <span class="ui-button-text"></span><span class="ui-button-icon-secondary ui-icon ui-icon-custom-plus-white"></span>
                      </div>
                      <div id="zoomGrapherOut" class="zoomGrapherBtn ui-button ui-widget ui-state-default ui-corner-all ui-button-icon-only" title="Zoom out the graphs">
                        <span class="ui-button-text"></span><span class="ui-button-icon-secondary ui-icon ui-icon-custom-minus-white"></span>
                      </div>
                    </td>
                </tr>
                <tr>
                  <td>
                    <div id="plot_container" class="plot_container"></div>
                    </td>
                    <td>
                      <div id="y_axis" class="y_axis">
                        <div id="y_axis_label" class="rotate_90 y_axis_label">(ug/m<sup>3</sup>)</div>
                      </div>
                    </td>
                </tr>
                <tr><td id="hover_sample_value_and_time"></td></tr>
              </table>
              <div id='grapher_legend'>
                <table id="graph_legend_content"></table>
              </div>
            </div>
          </div>
          <br>
          <div id="get-heatmap-button-container"><div id='get-heatmap'><span class="button-text">Generate Heatmap</span></div></div>   
        </div>
      </div>
      <div id="infobar-content">
        <a href="./"><div id="infobar-header" title="Air Tracker"></div></a>
        <div id="infobar-location-header"></div>
        <div id="infobar-initial" class="initial">
          <p>That air you're breathing, where's it been?</p>
          <p>AirTracker makes visual connections between the air you are breathing and the locations
            of air pollution sources in your city. Users can view source areas, which show where
            air comes from at any time.
            <br><br>
            Key interactive features include:
          </p>
          <ul>
            <li>View real-time air pollution and wind measurements across your city. Click on a blue circle, indicating an available city. Once the region has loaded, click on a circle to see these sensor measurements.</li>
            <br>
            <li>Click anywhere in the dotted region of the city to create a source area that "looks upwind" to see where the air came from to end up at that location, at that time. </li>
            <br>
            <li>When examining a city, explore past air pollution measurements and source areas that may influence air quality in a neighborhood. Choose a day on the timeline and click the clock in the lower left to explore data within that day.</li>
          </ul>
        </div>
        <div id="infobar-component-container">
          <div id="infobar-plume-section" class="infobar-component">
            <div class="infobar-component-header">Source Area: <span class='more-info' title="Learn more" data-info="side-panel-backtrace"></span><div class="plume-expand-icon" title="More details"></div></div>
            <div id="infobar-plume">
              <div class="plume-expand"></div>
              <div class="infobar-text"></div>
              <div class="infobar-data"></div>
              <div class="infobar-unit"></div>
              <div class="infobar-time"></div>
            </div>
            <div class="heatmap-modal-button-container"><button id="heatmap-btn">Generate heatmap of cumulative source area likelihoods over time</button></div>
          </div>
          <div id="infobar-pollution-section" class="infobar-component">
            <div class="infobar-component-header">PM<sub>2.5</sub>: <span class='more-info' title="Learn more" data-info="side-panel-data"></span><span class='chart-btn' title="Explore PM data over time"></span></div>
            <div id="infobar-pollution" class="infobar-component-value">
              <div class="infobar-text"><i>Click on the nearest sensor to see pollution measurements.</i></div>
              <div class="infobar-data"></div>
              <div class="infobar-unit"></div>
              <div class="infobar-time"></div>
            </div>
          </div>
          <div id="infobar-wind-section" class="infobar-component">
            <div class="infobar-component-header">Wind: <span class='more-info' title="Learn more" data-info="side-panel-data"></span></div>
            <div id="infobar-wind" class="infobar-component-value">
              <div class="infobar-text"><i>Click on the nearest sensor (with an arrow) to see wind measurements.</i></div>
              <div class="infobar-data-intro">Coming from</div>
              <div class="infobar-data"></div>
              <div class="infobar-unit"></div>
              <div class="infobar-time"></div>
            </div>
          </div>
        </div>
        <div id="infobar-close-handle-container">
          <div id="infobar-close-handle"></div>
        </div>
        <div id="infobar-close-toggle-container" title="Toggle infobar">
          <div class="infobar-close-toggle-icon"></div>
        </div>
        <div class='side-controls-container'>
          <div class="side-controls-container-column">
            <button id="city-picker" class="control-button">Explore a city</button>
            <button id="share-picker" class="control-button">Share</button>
            <button id="help-tour" class="control-button">Take a Tour</button>
            <button id="reach-out" class="control-button">Reach out</button>
            <button id="methodology" class="control-button">Methodology</button>
          </div>
          <div class="side-controls-container-column">
            <div class="searchBoxContainer">
              <input class="searchBox" placeholder="Search for a point of interest..." autocomplete="off">
              <span class="searchBoxIcon" title="Toggle search"></span>
              <span class="searchBoxClearIcon" title="Clear search"></span>
            </div>
            <button id="add-placemarker" class="control-button disabled">Add placemarker. Once added, it is draggable on the map.</button>
            <button id="remove-placemarkers" class="control-button disabled">Clear user added placemarkers</button>
          </div>
        </div>
      </div>
    </div>
    <div class="custom-legend noselect no-controls" id="legend">
      <h3 class="legend-title">Legend</h3>
      <div class="legend-scale">
        <table id="legend-table">
          <tr>
            <td>Date:</td>
            <td colspan="2" id="current-date-legend"></td>
          </tr>
          <tr id="backtrace-legend-row" class="legend-row force-hidden">
            <td class="entry-title">Source Area: <span class='more-info more-info-legend' title="Learn more" data-info="legend-backtrace"></span></td>
            <td colspan="2" class="backtrace-color-map"></td>
          </tr>
          <tr id="backtrace-details-legend-row" class="force-hidden">
            <td class="entry-title"></td>
            <td class="legend-label">Less Likely</td>
            <td class="legend-label backtrace-text2">More Likely</td>
          </tr>
          <tr id="air-now-legend-row" class="legend-row">
            <td class="entry-title two-rows">
              AirNow PM<sub>2.5</sub>:
              <br><span class="legend-row-units">(ug/m<sup>3</sup>)</span><span class='more-info more-info-legend' title="Learn more" data-info="legend-airnow"></span>
            </td>
            <td colspan="2">
              <table>
                <tr>
                  <td class="smell-color-td PM25-color-1"></td>
                  <td class="smell-color-td PM25-color-2"></td>
                  <td class="smell-color-td PM25-color-3"></td>
                  <td class="smell-color-td PM25-color-4"></td>
                  <td class="smell-color-td PM25-color-5"></td>
                </tr>
                <tr>
                  <td class="legend-label">0+</td>
                  <td class="legend-label">12+</td>
                  <td class="legend-label">35+</td>
                  <td class="legend-label">55+</td>
                  <td class="legend-label">150+</td>
                </tr>
              </table>
            </td>
          </tr>
          <tr id="purple-air-legend-row" class="legend-row">
            <td class="entry-title two-rows">
              PurpleAir PM<sub>2.5</sub>:
              <br><span class="legend-row-units">(ug/m<sup>3</sup>)</span><span class='more-info more-info-legend' title="Learn more" data-info="legend-purpleair"></span>
            </td>
            <td colspan="2">
              <table>
                <tr>
                  <td class="smell-color-td PM25-color-1b"></td>
                  <td class="smell-color-td PM25-color-2b"></td>
                  <td class="smell-color-td PM25-color-3b"></td>
                  <td class="smell-color-td PM25-color-4b"></td>
                  <td class="smell-color-td PM25-color-5b"></td>
                </tr>
                <tr>
                  <td class="legend-label">0+</td>
                  <td class="legend-label">12+</td>
                  <td class="legend-label">35+</td>
                  <td class="legend-label">55+</td>
                  <td class="legend-label">150+</td>
                </tr>
              </table>
            </td>
            <td>
              <label class="switch" title="Toggle PurpleAir sensors">
                <input type="checkbox" id="toggle-purple-air" data-marker-type="purple_air">
                <span class="slider round">
                  <span class="input-state-text"></span>
                </span>
              </label>
            </td>
          </tr>
          <tr id="clarity-legend-row" class="legend-row">
            <td class="entry-title two-rows">
              Clarity PM<sub>2.5</sub>:
              <br><span class="legend-row-units">(ug/m<sup>3</sup>)</span><span class='more-info more-info-legend' title="Learn more" data-info="legend-clarity"></span>
            </td>
            <td colspan="2">
              <table>
                <tr>
                  <td class="smell-color-td PM25-color-1b"></td>
                  <td class="smell-color-td PM25-color-2b"></td>
                  <td class="smell-color-td PM25-color-3b"></td>
                  <td class="smell-color-td PM25-color-4b"></td>
                  <td class="smell-color-td PM25-color-5b"></td>
                </tr>
                <tr>
                  <td class="legend-label">0+</td>
                  <td class="legend-label">12+</td>
                  <td class="legend-label">35+</td>
                  <td class="legend-label">55+</td>
                  <td class="legend-label">150+</td>
                </tr>
              </table>
            </td>
            <td>
              <label class="switch" title="Toggle Clarity sensors">
                <input type="checkbox" id="toggle-clarity" data-marker-type="clarity">
                <span class="slider round">
                  <span class="input-state-text"></span>
                </span>
              </label>
            </td>
          </tr>
          <tr id="quant-aq-legend-row" class="legend-row">
            <td class="entry-title two-rows">
              QuantAQ PM<sub>2.5</sub>:
              <br><span class="legend-row-units">(ug/m<sup>3</sup>)</span><span class='more-info more-info-legend' title="Learn more" data-info="legend-quant-aq"></span>
            </td>
            <td colspan="2">
              <table>
                <tr>
                  <td class="smell-color-td PM25-color-1b"></td>
                  <td class="smell-color-td PM25-color-2b"></td>
                  <td class="smell-color-td PM25-color-3b"></td>
                  <td class="smell-color-td PM25-color-4b"></td>
                  <td class="smell-color-td PM25-color-5b"></td>
                </tr>
                <tr>
                  <td class="legend-label">0+</td>
                  <td class="legend-label">12+</td>
                  <td class="legend-label">35+</td>
                  <td class="legend-label">55+</td>
                  <td class="legend-label">150+</td>
                </tr>
              </table>
            </td>
            <td>
              <label class="switch" title="Toggle QuantAQ sensors">
                <input type="checkbox" id="toggle-quant-aq" data-marker-type="quant_aq">
                <span class="slider round">
                  <span class="input-state-text"></span>
                </span>
              </label>
            </td>
          </tr>
          <tr id="smell-report-legend-row" class="legend-row">
            <td class="entry-title">
              Smell Reports:
            </td>
            <td colspan="2">
              <table>
                <tr>
                  <td class="smell-color-td smell-color-1"></td>
                  <td class="smell-color-td smell-color-2"></td>
                  <td class="smell-color-td smell-color-3"></td>
                  <td class="smell-color-td smell-color-4"></td>
                  <td class="smell-color-td smell-color-5"></td>
                </tr>
              </table>
            </td>
          </tr>
          <tr id="trax-legend-row" class="legend-row">
            <td class="entry-title two-rows">
              TRAX PM<sub>2.5</sub>:
              <br><span class="legend-row-units">(ug/m<sup>3</sup>)</span><span class='more-info more-info-legend' title="Learn more" data-info="legend-trax"></span>
            </td>
            <td colspan="2">
              <span class="trax-color-1 trax-span opacity-25"></span>
              <span class="trax-color-1 trax-span opacity-50"></span>
              <span class="trax-color-1 trax-span opacity-75"></span>
              <span class="trax-color-1 trax-span"></span>
              <span class="trax-color-1 trax-span"></span>
              <span class="trax-color-2 trax-span"></span>
              <span class="trax-color-2 trax-span"></span>
              <span class="trax-color-3 trax-span"></span>
              <span class="trax-color-3 trax-span"></span>
              <span class="trax-color-4 trax-span"></span>
              <span class="trax-color-4 trax-span"></span>
              <span class="trax-color-5 trax-span"></span>
              <span class="trax-color-5 trax-span"></span>
              <span class="trax-color-5 trax-span opacity-75"></span>
              <span class="trax-color-5 trax-span opacity-50"></span>
              <span class="trax-color-5 trax-span opacity-25"></span>
            </td>
            <td>
              <label class="switch" title="Toggle TRAX sensors">
                <input type="checkbox" id="toggle-trax" data-marker-type="trax">
                <span class="slider round">
                  <span class="input-state-text"></span>
                </span>
              </label>
            </td>
          </tr>
          <tr id="wind-legend-row">
            <td class="entry-title">Wind: <span class='more-info more-info-legend' title="Learn more" data-info="legend-wind"></span></td>
            <td colspan="4" class="wind-arrow-td wind-arrow"></td>
          </tr>
          <tr id="facilities-legend-row">
            <td class="entry-title">Industrial <br> Facilities: <span class='more-info more-info-legend' title="Learn more" data-info="legend-facilities"></span></td>
            <td colspan="2" class="facilities-td facilities"></td>
            <td>
              <label class="switch" title="Toggle facility markers and boundaries">
                <input type="checkbox" id="toggle-facilities" data-marker-type="facilities">
                <span class="slider round">
                  <span class="input-state-text"></span>
                </span>
              </label>
            </td>
          </tr>
        </table>
      </div>
    </div>
    <div id="map" class="no-controls"></div>
    <div id="footprint-first-click-dialog" title="Reminder!">
      <div id="explanation-content-container">
        <div id="explanation-1" class="explanation-content">
          Clicking on the map will show you the <b>source area</b> for that location at the selected time. <br><br>
          The visible area reveals the most likely origin of the air at your selected location. <br><br>
          The air in the grey area is most likely not reaching your selected location.<br><br>
        </div>
        <div id="explanation-2" class="explanation-content">
          <h4>Wind:</h4>
          The wind arrow points in the direction that the air is blowing. While the weather models that Air Tracker uses are quite reliable, they are not always perfect.
          Here is what to look for:
          <br><br>
          <div><img src="./assets/img/edf-wind-pt1a.jpg"></div>
          <br>
          <div><img src="./assets/img/edf-wind-pt1b.jpg"></div>
          <br>
          <div><img src="./assets/img/edf-wind-pt1c.jpg"></div>
          <br>
          In the above examples when the wind arrow overlaps with the source area, we have a lot of confidence that the source area is correct.
          <br><br>
          And then in this different set of examples below, when the wind arrow and source area don't match, we have less confidence that the source area is correct.
          <br><br>
          <div><img src="./assets/img/edf-wind-pt2a.jpg"></div>
          <br>
          <div><img src="./assets/img/edf-wind-pt2b.jpg"></div>
          <br>
          <div><img src="./assets/img/edf-wind-pt2c.jpg"></div>
          <br>
        </div>
      </div>
      <div id="explanationstep-container" data-max-steps="2" data-current-step="1">
        <a id="explanationstep-back" class="explanation-step-button disabled" data-direction="-1" href="javascript:void(0)">&xlarr; BACK</a> | <a id="explanationstep-forward" class="explanation-step-button" data-direction="1" href="javascript:void(0)">NEXT &xrarr;</a>
      </div>
      <br><br>
      <div id="checkbox-container">
        <input type="checkbox" id="dont-show-again" name="dont-show-again" value="Don't Show Me Again">
        <label for="dont-show-again">Don't show me this reminder again</label>
      </div>
    </div>
    <div id="calendar-dialog" title="Calendar" data-role="none">
      <p>Select a year to explore:</p>
      <input type="hidden" autofocus="autofocus" />
      <select id="calendar" data-role="none"></select>
    </div>
    <div class="shareViewModal">
      <div id="share-link-container-main">
        <p class="heading">Share URL</p>
        <div class="share-link-container-content">
          <div class="shareurl always-selectable"></div>
          <span class="copy-text-button shareurl-copy-text-button" title="Click to copy to clipboard"></span>
        </div>
      </div>
      <div id="embed-link-container-main">
        <br>
        <p class="heading">Share Screenshot</p>
        <div id='get-screenshot-container'>
          <div id='get-screenshot'>Capture Screenshot</div>
          <span id='get-screenshot-description'>(Download an image of the current viewport. <br>Make your browser window larger or smaller to change the output resolution.)</span>
        </div>
      </div>
      <span class="close-modal" title="Close"></span>
    </div>
    <div class="reachOutModal">
      <div>
        <p class="heading">Contact</p>
        <div>Have any questions? Would you like to see Air Tracker in your neighborhood? Let us know at <a href="mailto:AirTracker@edf.org">AirTracker@edf.org</a></div>
      </div>
      <span class="close-modal" title="Close"></span>
    </div>
    <div class="methodologyModal">
      <div>
        <p class="heading">Learn More</p>
        <div><a href="https://airtracker.createlab.org/assets/data/20220524_Air_Tracker_Methodology.pdf" target="_blank">Read more</a> about our methodology.</div>
      </div>
      <span class="close-modal" title="Close"></span>
    </div>
    <div class="backtraceSettingsModal">
      <div>
        <p class="heading">Source Area Settings</p>
        <table>
          <tr>
            <td>Show contribution likelihoods:</td>
            <td>
              <label class="switch" title="Show backtrace contribution likelihoods">
                <input type="checkbox" id="toggle-backtrace-likelihood">
                <span class="slider round">
                  <span class="input-state-text"></span>
                </span>
              </label>
            </td>
          </tr>
          <tr>
            <td>Show detailed uncertainty info:</td>
            <td>
              <label class="switch" title="Show detailed uncertainty info">
                <input type="checkbox" id="toggle-uncertainty-details">
                <span class="slider round">
                  <span class="input-state-text"></span>
                </span>
              </label>
            </td>
          </tr>
        </table>
      </div>
      <span class="close-modal" title="Close"></span>
    </div>
    <div class="tosModal">
      <div class="content">
        <h3>AIR TRACKER TERMS OF USE</h3>
        <p>
          EDF's mission is to link science, economics, law, and innovative private-sector partnerships to create transformational solutions to the most serious environmental problems.
          Air Tracker is designed to provide people and communities with general available information about air quality in their area by presenting data from a number of public resources
          in a common interface.
        </p>
        <p>
          These Terms of Use (the "Terms") are by and between the Environmental Defense Fund, Inc, a New York nonprofit corporation ("EDF") and, you, the individual or entity accessing the
          Air Tracker application and data.  By accessing and using Air Tracker, you acknowledge and agreed that, as of the date you first access Air Tracker, you have read, understand and
          accept these terms. These terms may change from time to time, so your continued access to and use of Air Tracker means you consent to those changes.
        </p>
        <p>
          Air Tracker is made available strictly for general informational, non-commercial purposes only. Air Tracker data should not be taken as professional, legal or health related
          advice nor be relied upon as a source of information for any legal or regulatory action or health related decisions.  You may use the information available on Air Tracker to
          inform yourself.
        </p>
        <p>
          For example, you are permitted to:
          <ul>
            <li>Use Air Tracker for your own information and education</li>
            <li>Link to the Air Tracker site using the following link: [<a href="https://globalcleanair.org/air-tracker" target="_blank">https://globalcleanair.org/air-tracker</a>]</li>
            <li>Use and report images from Air Tracker*</li>
            <li>Use Air Tracker to inform your community*</li>
            <li>Use Air Tracker for school projects*</li>
          *whenever you reference Air Tracker or information you use from this site, you must clearly identify it as "Air Tracker information subject to the Air Tracker Terms of Use").</li>
          But you:
            <li>Will not use EDF Air Tracker in any manner to interfere with, disrupt, negatively affect or inhibit other users from fully enjoying Air Tracker, or that could damage, disable, overburden or impair the functioning of any service(s) by which it may be made available.
            <li>Will not modify Air Tracker or any service(s) through which it is made available;
            <li>Not remove any references to Air Tracker, EDF or the public sources of the Air Tracker information;
            <li>Will Not use Air Tracker as a part of any other application without prior written consent from us;
            <li>Not mine any of the Air Tracker data or use any bots or similar data gathering or extraction methods designed to scrape or extract data from Air Tracker;
            <li>Not use Air Tracker for any illegal or unauthorized purpose, to enable any high-risk activities or otherwise engage in, encourage or promote any activity that violates these Terms.
          </ul>
        </p>
        <p>
          Air Tracker are provided at no charge. Air Tracker data is made available to you without any need to register or for us to collect Personal Data online from users.
          The limited permissions to access and use Air Tracker are nonexclusive and may be changed or revoked at any time. Any use of the Services other than as specifically
          authorized herein is strictly prohibited, will terminate your permission to use Air Tracker and may result in liability to you.
        </p>
        <p>
          TO THE FULLEST EXTENT PERMITTED BY APPLICABLE LAW, AIR TRACKER (INCLUDING, WITHOUT LIMITATION, ANY AND ALL DATA, TEXT, GRAPHICS, IMAGES, PHOTOGRAPHS, ILLUSTRATIONS,
          AND INFORMATION OF ANY KIND, WHETHER EXPRESS, IMPLIED OR INFERRED) IS PROVIDED WITH NO REPRESENTATION OR WARRANTY OF ANY KIND, WHETHER EXPRESS, IMPLIED, STATUTORY OR
          OTHERWISE, INCLUDING WITHOUT LIMITATION WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR USE, AVAILABILITY, ACCESSIBILITY, ACCURACY, AND NONINFRINGEMENT.
          NEITHER EDF NOR ANY OF THE THIRD PARTY PUBLIC SOURCES OF THE AIR TRACKER DATA ARE LIABLE UNDER THIS AGREEMENT TO YOU OR ANYONE ELSE FOR ANY INDIRECT, SPECIAL, INCIDENTAL,
          CONSEQUENTIAL, EXEMPLARY, OR PUNITIVE DAMAGES, EVEN IF SUCH DAMAGES WERE POSSIBLE AND EVEN IF DIRECT DAMAGES ARE NOT A REMEDY. IN ANY EVENT, NO LIABILITY UNDER THESE TERMS
          WILL EXCEED MORE THAN FIVE HUNDRED DOLLARS (USD $500).
        </p>
        <p>
          Air Tracker was developed using publicly available data from the following sources:
          <ul>
            <li><a href="https://www.epa.gov/toxics-release-inventory-tri-program" target="_blank">Toxic Releases Inventory (TRI)</a></li>
            <li><a href="https://www.epa.gov/air-emissions-inventories/national-emissions-inventory-nei" target="_blank">National Emissions Inventory (NEI)</a></li>
            <li><a href="https://www.epa.gov/frs" target="_blank">Facility Registry Service (FRS)</a></li>
            <li><a href="https://www.airnow.gov/" target="_blank">AirNow</a></li>
            <li><a href="https://map.purpleair.com/" target="_blank">PurpleAir</a></li>
            <li><a href="https://openmap.clarity.io/" target="_blank">Clarity</a></li>
            <li><a href="https://mesowest.utah.edu/" target="_blank">MesoWest</a></li>
            <li><a href="https://tnris.org/" target="_blank">Texas Natural Resources Information System (TNRIS)</a></li>
          </ul>
        </p>
        <p>
          Air Tracker and all data offered through the application, including any text, graphics, images, photographs, videos, illustrations, information of any kind,
          and other content contained, implied or inferred therein were created by EDF, the data providers listed above, as well as other licensors and distributors and
          may be protected under US law(s).  Except as explicitly stated in these terms, all rights in and to the data, application, and services are reserved by EDF, the
          public sources of the data, and any other licensors and distributors.
        </p>
        <p>
          These Terms constitute the entire agreement between you and EDF with respect to your use of the EDF Air Tracker and that no joint venture, partnership,
          employment, agency or other relationship exists between you and EDF as a result of these terms or your use of the EDF Air Tracker. Our failure to exercise
          or enforce any right or provision of these terms does not constitute a waiver of such right or provision. If any provision of these terms is found by a court
          of competent jurisdiction to be invalid, the parties nevertheless agree that the court should endeavor to give effect to the parties' intentions as reflected in
          the provision, and the other provisions of the Terms remain in full force and effect.
        </p>
        <p>
          IF YOU DISAGREE WITH ANY OF THESE TERMS, THEN YOU SHOULD NOT ACCESS AIR TRACKER AND YOU DO NOT HAVE PERMISSION TO USE ANY INFORMATION FROM AIR TRACKER.
        </p>
        <p>
          If you have questions, send an email to <a href="mailto:AirTracker@edf.org">AirTracker@edf.org</a>
        </p>
      </div>
      <div class="footer">
        <input id="tos-agree" type="checkbox">
        <label for="tos-agree"> I agree to the above Terms and Conditions.</label>
      </div>
    </div>
    <div id="city-picker-controls">
      <select id="city-selector"></select>
    </div>
    <span class="button-tooltip">
      <p></p>
    </span>
    <input class='mobile-menu-toggle' type="checkbox" id="active">
    <label class='mobile-menu-toggle menu-btn' for="active"><span></span></label>
    <label class='mobile-menu-toggle close' for="active"></label>
    <div id='mobile-menu'>
      <div class="searchModal">
          <div class="searchBoxContainer">
            <p class="heading">Search</p>
            <input class="searchBox searchBoxMobile" placeholder="Search for a point of interest..." autocomplete="off">
            <span class="searchBoxClearIcon" title="Clear search"></span>
          </div>
          <span class="close-modal" title="Close"></span>
        </div>
      <div class="wrapper">
        <ul>
          <li id="city-picker-mobile"><span class="mobile-city-picker-icon"></span><a href="#">Explore a City</a></li>
          <li id="share-picker-mobile"><span class="mobile-share-icon"></span><a href="#">Share</a></li>
          <!-- <li id="help-tour-mobile"><span class="mobile-tour-icon"></span><a href="#">Tour</a></li> -->
          <li id="reach-out-mobile"><span class="mobile-reach-out-icon"></span><a href="#">Reach Out</a></li>
          <li id="methodology-mobile"><span class="mobile-methodology-icon"></span><a href="#">Methodology</a></li>
          <li id="search-mobile">
            <span class="searchBoxIconMobile" title="Toggle search"></span>
            <a href="#">Search</a>
            <!-- <div class="searchBoxContainer">
              <input class="searchBox searchBoxMobile" placeholder="Search for a point of interest..." autocomplete="off">
              <span class="searchBoxClearIcon" title="Clear search"></span>
            </div> -->
          </li>
        </ul>
      </div>
    </div>
  </body>
</html>