<!DOCTYPE html>
<html>
  <head>
    <title>Air Tracker</title>
    <meta charset="utf-8" name="viewport" content="width=device-width, initial-scale=1">

    <link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css" />
    <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Open+Sans:400,700" />
    <link rel="stylesheet" type="text/css" href="https://code.jquery.com/ui/1.13.1/themes/smoothness/jquery-ui.min.css" />
    <link rel="stylesheet" type="text/css" href="./assets/css/controls.css" />
    <link rel="stylesheet" type="text/css" href="./assets/css/widgets.css" />
    <link rel="stylesheet" type="text/css" href="./assets/css/TimelineHeatmap.css" />
    <link rel="stylesheet" type="text/css" href="./assets/css/style.css" />
    <link rel="stylesheet" type="text/css" href="./assets/css/materialUI.css" />
    <link rel="stylesheet" type="text/css" href="./assets/css/bootstrap-fullscreen-select.min.css" />
    <link rel="stylesheet" type="text/css" href="./assets/css/introjs.min.css" />

    <script type="text/javascript" src="https://polyfill.io/v3/polyfill.min.js?features=default"></script>
    <script type="text/javascript" src="https://maps.googleapis.com/maps/api/js?key=AIzaSyC6eawl6aLg9CHsJGc86qKcORA3vTcDZUQ&callback=initMap&libraries=geometry,places&v=weekly" defer></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.29.1/moment.min.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/moment-timezone/0.5.33/moment-timezone-with-data-10-year-range.min.js"></script>
    <script type="text/javascript" src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script type="text/javascript" src="https://code.jquery.com/ui/1.13.1/jquery-ui.min.js"></script>
    <script type="text/javascript" src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
    <script type="text/javascript" src="https://www.gstatic.com/firebasejs/8.10.0/firebase-auth.js"></script>
    <script type="text/javascript" src="https://www.gstatic.com/firebasejs/8.10.0/firebase-firestore.js"></script>
    <script type="text/javascript" src="./assets/js/TimelineHeatmap.js" type="text/javascript"></script>
    <script type="text/javascript" src="./assets/js/widgets.js"></script>
    <script type="text/javascript" src="./assets/js/Util.js"></script>
    <script type="text/javascript" src="./assets/js/customTimeline2.js"></script>
    <script type="text/javascript" src="./assets/js/index.js"></script>
    <script type="text/javascript" src="./assets/js/timeline.js"></script>
    <script type="text/javascript" src="./assets/js/purpleAirTourHelpers.js"></script>
    <script type="text/javascript" src="./assets/lib/gmaps-utils/map_marker/CustomMapMarker.js"></script>
    <script type="text/javascript" src="./assets/lib/touchPunch/jquery.ui.touch-punch.min.js"></script>
    <script type="text/javascript" src="./assets/lib/bootstrapFullscreenSelect/bootstrap-fullscreen-select.min.js"></script>
    <script type="text/javascript" src="./assets/lib/scrollIntoView/scrollIntoView.min.js"></script>
    <script type="text/javascript" src="./assets/lib/html2canvas/html2canvas.min.js"></script>
    <script type="text/javascript" src="./assets/lib/downloadjs/download.min.js"></script>
    <script type="text/javascript" src="./assets/lib/js-markerwithlabel/js-markerwithlabel-1.3.11.min.js"></script>
    <script type="text/javascript" src="./assets/lib/introjs/intro.min.js"></script>
  </head>
  <body class="materialUI">
    <div id="controls" class="playbackTimelineOff" style="display: none">
      <div id="playback-timeline-container" class="noselect materialUI">
        <div class="materialTimelineContainerMain">
          <div class="materialTimelineContainer">
            <div class="timestampPreview disabled" title="Explore more hours in this day"><div id="currentTime"></div></div>
            <div class="playbackButton" title="Play"></div>
            <div class="leftSeekControl" title="Click to seek backward. Press and hold to jump to a different hour."><span class="leftSeekControlIcon"></span></div>
            <div class="materialTimeline"></div>
            <div class="rightSeekControl" title="Click to seek forward. Press and hold to jump to a different hour."><span class="rightSeekControlIcon"></span></div>
          </div>
        </div>
        <div id="timeJumpControl" title="Jump to an hour"></div>
      </div>
      <div id="timeline-container" class="noselect timeline-container"></div>
      <div id="timeline-handle" class="noselect force-no-visibility"><span>Daily AQI&nbsp;-&nbsp;</span><span id='city_name'></span></div>
      <button id="calendar-btn" title="Calendar" class="force-hidden custom-button-flat calendar-default-icon" disabled>
        <div class="calendar-specific-day hidden"></div>
      </button>
    </div>
    <div id="infobar" class='infocontainer no-controls'>
      <div id="infobar-content">
        <div id="infobar-header">Air Tracker</div>
        <div id="infobar-location-header"></div>
        <div id="infobar-initial" class="initial">
          <p>That air you’re breathing, where’s it been?</p>
          <p>AirTracker makes visual connections between the air you are breathing and the locations
            of air pollution sources in your city. Users can view back traces, which show where
            air comes from at any time.
            <br><br>
            Key interactive features include:
          </p>
          <ul>
            <li>View real-time air pollution and wind measurements across your city. Click on a blue circle, indicating an available city. Once the region has loaded, click on a circle to see these sensor measurements.</li>
            <br>
            <li>Click anywhere in the dotted region of the city to create a back trace that "looks upwind" to see where the air came from to end up at that location, at that time. </li>
            <br>
            <li>When examining a city, explore past air pollution measurements and back traces to learn more about areas that may influence air quality in a neighborhood. Choose a day on the timeline and click the clock in the lower left to explore data within that day.</li>
          </ul>
        </div>
        <div id="infobar-component-container">
          <div id="infobar-plume-section" class="infobar-component">
            <div class="infobar-component-header">Backtrace: </div>
            <div id="infobar-plume">
              <div class="infobar-text"></div>
              <div class="infobar-data"></div>
              <div class="infobar-unit"></div>
              <div class="infobar-time"></div>
            </div>
          </div>
          <div id="infobar-pollution-section" class="infobar-component">
            <div class="infobar-component-header">PM<sub>2.5</sub>: <span class='more-info'></span></div>
            <div id="infobar-pollution" class="infobar-component-value">
              <div class="infobar-text"><i>Click on the nearest sensor to see pollution measurements.</i></div>
              <div class="infobar-data"></div>
              <div class="infobar-unit"></div>
              <div class="infobar-time"></div>
            </div>
          </div>
          <div id="infobar-wind-section" class="infobar-component">
            <div class="infobar-component-header">Wind: <span class='more-info'></span></div>
            <div id="infobar-wind" class="infobar-component-value">
              <div class="infobar-text"><i>Click on the nearest sensor (with an arrow) to see wind measurements.</i></div>
              <div class="infobar-data-intro">Coming from</div>
              <div class="infobar-data"></div>
              <div class="infobar-unit"></div>
              <div class="infobar-time"></div>
            </div>
          </div>
        </div>
        <div id="infobar-close-handle-container">
          <div id="infobar-close-handle"></div>
        </div>
        <div id="infobar-close-toggle-container" title="Toggle infobar">
          <div class="infobar-close-toggle-icon"></div>
        </div>
        <div class='side-controls-container'>
          <button id="city-picker">
            Explore a city
          </button>
          <button id="share-picker">
            Share
          </button>
          <button id="help-tour">
            Help
          </button>
          <button id="reach-out">
            Reach out
          </button>
          <div class="searchBoxContainer">
            <input class="searchBox" placeholder="Search for a point of interest..." autocomplete="off">
            <span class="searchBoxIcon" title="Toggle search"></span>
            <span class="searchBoxClearIcon" title="Clear search"></span>
          </div>
        </div>
      </div>
    </div>
    <div class="custom-legend noselect no-controls" id="legend">
      <h3 class="legend-title">Legend</h3>
      <div class="legend-scale">
        <table id="legend-table">
          <tr>
            <td>Date:</td>
            <td colspan="2" id="current-date-legend"></td>
          </tr>
          <tr id="backtrace-legend-row" class="legend-row">
            <td class="entry-title">Backtrace: </td>
            <td colspan="2" class="backtrace-color-map"></td>
          </tr>
          <tr id="backtrace-details-legend-row">
            <td class="entry-title"></td>
            <td class="legend-label">Less Likely</td>
            <td class="legend-label backtrace-text2">More Likely</td>
          </tr>
          <tr id="air-now-legend-row" class="legend-row">
            <td class="entry-title two-rows">
              AirNow PM<sub>2.5</sub>:
              <br><span class="legend-row-units">(ug/m<sup>3</sup>)</span>
            </td>
            <td colspan="2">
              <table>
                <tr>
                  <td class="smell-color-td PM25-color-1"></td>
                  <td class="smell-color-td PM25-color-2"></td>
                  <td class="smell-color-td PM25-color-3"></td>
                  <td class="smell-color-td PM25-color-4"></td>
                  <td class="smell-color-td PM25-color-5"></td>
                </tr>
                <tr>
                  <td class="legend-label">0+</td>
                  <td class="legend-label">12+</td>
                  <td class="legend-label">35+</td>
                  <td class="legend-label">55+</td>
                  <td class="legend-label">150+</td>
                </tr>
              </table>
            </td>
          </tr>
          <tr id="purple-air-legend-row" class="legend-row">
            <td class="entry-title two-rows">
              PurpleAir PM<sub>2.5</sub>:
              <br><span class="legend-row-units">(ug/m<sup>3</sup>)</span>
            </td>
            <td colspan="2">
              <table>
                <tr>
                  <td class="smell-color-td PM25-color-1b"></td>
                  <td class="smell-color-td PM25-color-2b"></td>
                  <td class="smell-color-td PM25-color-3b"></td>
                  <td class="smell-color-td PM25-color-4b"></td>
                  <td class="smell-color-td PM25-color-5b"></td>
                </tr>
                <tr>
                  <td class="legend-label">0+</td>
                  <td class="legend-label">12+</td>
                  <td class="legend-label">35+</td>
                  <td class="legend-label">55+</td>
                  <td class="legend-label">150+</td>
                </tr>
              </table>
            </td>
            <td>
              <label class="switch" title="Toggle PurpleAir sensors">
                <input type="checkbox" id="toggle-purple-air" data-marker-type="purple_air">
                <span class="slider round">
                  <span class="input-state-text"></span>
                </span>
              </label>
            </td>
          </tr>
          <tr id="clarity-legend-row" class="legend-row">
            <td class="entry-title two-rows">
              Clarity PM<sub>2.5</sub>:
              <br><span class="legend-row-units">(ug/m<sup>3</sup>)</span>
            </td>
            <td colspan="2">
              <table>
                <tr>
                  <td class="smell-color-td PM25-color-1c"></td>
                  <td class="smell-color-td PM25-color-2c"></td>
                  <td class="smell-color-td PM25-color-3c"></td>
                  <td class="smell-color-td PM25-color-4c"></td>
                  <td class="smell-color-td PM25-color-5c"></td>
                </tr>
                <tr>
                  <td class="legend-label">0+</td>
                  <td class="legend-label">12+</td>
                  <td class="legend-label">35+</td>
                  <td class="legend-label">55+</td>
                  <td class="legend-label">150+</td>
                </tr>
              </table>
            </td>
            <td>
              <label class="switch" title="Toggle Clarity sensors">
                <input type="checkbox" id="toggle-clarity" data-marker-type="clarity">
                <span class="slider round">
                  <span class="input-state-text"></span>
                </span>
              </label>
            </td>
          </tr>
          <tr id="smell-report-legend-row" class="legend-row">
            <td class="entry-title">
              Smell Reports:
            </td>
            <td colspan="2">
              <table>
                <tr>
                  <td class="smell-color-td smell-color-1"></td>
                  <td class="smell-color-td smell-color-2"></td>
                  <td class="smell-color-td smell-color-3"></td>
                  <td class="smell-color-td smell-color-4"></td>
                  <td class="smell-color-td smell-color-5"></td>
                </tr>
              </table>
            </td>
          </tr>
          <tr id="trax-legend-row" class="legend-row">
            <td class="entry-title two-rows">
              TRAX PM<sub>2.5</sub>:
              <br><span class="legend-row-units">(ug/m<sup>3</sup>)</span>
            </td>
            <td colspan="2">
              <span class="trax-color-1 trax-span opacity-25"></span>
              <span class="trax-color-1 trax-span opacity-50"></span>
              <span class="trax-color-1 trax-span opacity-75"></span>
              <span class="trax-color-1 trax-span"></span>
              <span class="trax-color-1 trax-span"></span>
              <span class="trax-color-2 trax-span"></span>
              <span class="trax-color-2 trax-span"></span>
              <span class="trax-color-3 trax-span"></span>
              <span class="trax-color-3 trax-span"></span>
              <span class="trax-color-4 trax-span"></span>
              <span class="trax-color-4 trax-span"></span>
              <span class="trax-color-5 trax-span"></span>
              <span class="trax-color-5 trax-span"></span>
              <span class="trax-color-5 trax-span opacity-75"></span>
              <span class="trax-color-5 trax-span opacity-50"></span>
              <span class="trax-color-5 trax-span opacity-25"></span>
            </td>
            <td>
              <label class="switch" title="Toggle TRAX sensors">
                <input type="checkbox" id="toggle-trax" data-marker-type="trax">
                <span class="slider round">
                  <span class="input-state-text"></span>
                </span>
              </label>
            </td>
          </tr>
          <tr id="wind-legend-row">
            <td class="entry-title">Wind:</td>
            <td colspan="4" class="wind-arrow-td wind-arrow"></td>
          </tr>
        </table>
      </div>
    </div>
    <div id="map" class="no-controls"></div>
    <div id="footprint-first-click-dialog" title="Reminder!">
      <div id="explanation-content-container">
        <div id="explanation-1" class="explanation-content">
          Clicking on the map will show you the <b>pollution backtrace</b> for that place at the selected time. <br><br>
          The dark purple area is the area that the air parcels at your selected location most likely came <i>from.</i> <br><br>
          As the color fades to white, this shows areas that are less and less likely to have contributed air parcels to the location you selected.
        </div>
        <div id="explanation-2" class="explanation-content">
          <h4>Wind:</h4>
          The wind arrow points in the direction that the air is blowing. It is positioned based on real-time meteorological measurements at that site.
          The back trace uses wind data from a weather model data developed by NOAA. While those weather models are quite good, they do not always match
          measured data exactly. Here is what to look for:
          <br><br>
          <div><img src="./assets/img/edf-wind-pt1.jpg"></div>
          <br>
          See how the wind arrow overlaps with the back trace, and they both point into the selected location (red pin)? That suggests that the model wind
          direction agrees with the measured wind direction, and we have a lot of confidence that the back trace is correct.
          <br><br>
          When the wind arrow and the back trace don’t match:
          <br><br>
          <div><img src="./assets/img/edf-wind-pt2.jpg"></div>
          <br>
          See how the arrow and the back trace don’t line up at all? This means we have less confidence that the back trace is correct.
        </div>
      </div>
      <div id="explanationstep-container" data-max-steps="2" data-current-step="1">
        <a id="explanationstep-back" class="explanation-step-button disabled" data-direction="-1" href="javascript:void(0)">&xlarr; BACK</a> | <a id="explanationstep-forward" class="explanation-step-button" data-direction="1" href="javascript:void(0)">NEXT &xrarr;</a>
      </div>
      <br><br>
      <div id="checkbox-container">
        <input type="checkbox" id="dont-show-again" name="dont-show-again" value="Don't Show Me Again">
        <label for="dont-show-again">Don't show me this reminder again</label>
      </div>
    </div>
    <div id="calendar-dialog" title="Calendar" data-role="none">
      <p>Select a year to explore:</p>
      <input type="hidden" autofocus="autofocus" />
      <select id="calendar" data-role="none"></select>
    </div>
    <div class="shareViewModal">
      <div id="share-link-container-main">
        <p class="heading">Share URL</p>
        <div class="share-link-container-content">
          <div class="shareurl always-selectable"></div>
          <span class="copy-text-button shareurl-copy-text-button" title="Click to copy to clipboard"></span>
        </div>
      </div>
      <div id="embed-link-container-main">
        <br>
        <p class="heading">Share Screenshot</p>
        <div id='get-screenshot-container'>
          <div id='get-screenshot'>Capture Screenshot</div>
          <span id='get-screenshot-description'>(Download an image of the current viewport. <br>Make your browser window larger or smaller to change the output resolution.)</span>
        </div>
      </div>
      <span class="close-modal" title="Close"></span>
    </div>
    <div class="reachOutModal">
      <div>
        <p class="heading">Learn More</p>
        <div>Read more about our methodology <a href="https://docs.google.com/document/d/1lleQIVY1aq89n9kFmljzW-FxjRRgghTlOcFbTwNkQUY/edit?usp=sharing" target="_blank">here.</a></div>
        <br>
        <p class="heading">Contact</p>
        <div>Have any questions? Would you like to see Air Tracker in your neighborhood? Let us know at <a href="mailto:AirTracker@edf.org">AirTracker@edf.org</a></div>
      </div>
      <span class="close-modal" title="Close"></span>
    </div>
    <div id="city-picker-controls">
      <select id="city-selector"></select>
    </div>
    <span class="button-tooltip">
      <p></p>
    </span>
    <input class='mobile-menu-toggle' type="checkbox" id="active">
    <label class='mobile-menu-toggle menu-btn' for="active"><span></span></label>
    <label class='mobile-menu-toggle close' for="active"></label>
    <div id='mobile-menu'>
      <div class="searchModal">
          <div class="searchBoxContainer">
            <p class="heading">Search</p>
            <input class="searchBox searchBoxMobile" placeholder="Search for a point of interest..." autocomplete="off">
            <span class="searchBoxClearIcon" title="Clear search"></span>
          </div>
          <span class="close-modal" title="Close"></span>
        </div>
      <div class="wrapper">
        <ul>
          <li id="city-picker-mobile"><span class="mobile-city-picker-icon"></span><a href="#">City Picker</a></li>
          <li id="share-picker-mobile"><span class="mobile-share-icon"></span><a href="#">Share</a></li>
          <!-- <li id="help-tour-mobile"><span class="mobile-tour-icon"></span><a href="#">Tour</a></li> -->
          <li id="reach-out-mobile"><span class="mobile-reach-out-icon"></span><a href="#">Reach Out</a></li>
          <li id="search-mobile">
            <span class="searchBoxIconMobile" title="Toggle search"></span>
            <a href="#">Search</a>
            <!-- <div class="searchBoxContainer">
              <input class="searchBox searchBoxMobile" placeholder="Search for a point of interest..." autocomplete="off">
              <span class="searchBoxClearIcon" title="Clear search"></span>
            </div> -->
          </li>
        </ul>
      </div>
    </div>
  </body>
</html>